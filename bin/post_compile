echo "=> Performing database migrations..."
python manage.py migrate --settings=liberajus-api-backend.settings.production

echo "=> Collecting static files..."
python manage.py collectstatic --noinput --settings=liberajus-api-backend.settings.production

echo "=> Applying fixtures..."
for i in $(find . -wholename "*/fixtures/*.json"  -printf "%f\n" | sort -t '\0' -n); do \
    echo "Loading $i" ;\
    find -name $i -exec python manage.py loaddata {} --settings=liberajus-api-backend.settings.production  \; ;\
done

echo "=> Compiling translations..."
python manage.py compilemessages --settings=liberajus-api-backend.settings.production
